<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<BorderPane xmlns:fx="http://javafx.com/fxml/1"
            xmlns="http://javafx.com/javafx/17.0.12"
            fx:controller="gui.controller.AuditViewController">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <center>
        <VBox alignment="TOP_CENTER" spacing="16.0">

            <!-- Header -->
            <VBox alignment="CENTER" spacing="6">
                <Label alignment="CENTER" maxWidth="Infinity"
                       style="-fx-font-size: 20px; -fx-font-weight: bold;"
                       text="Audit Tool: Dokumenten-Organisation"/>
                <Label style="-fx-font-size: 11px; -fx-text-fill: gray;"
                       text="Pfad Verträge: X:\...\Vertragsliste.xlsx"/>
                <Label style="-fx-font-size: 11px; -fx-text-fill: gray;"
                       text="Pfad Schaden:  X:\...\Schadenliste.xlsx"/>
            </VBox>

            <Separator prefWidth="800"/>

            <!-- Deux colonnes : gauche = Schaden, droite = Vertrag -->
            <HBox alignment="TOP_CENTER" spacing="24">

                <!-- COLONNE GAUCHE : SCHADEN -->
                <VBox prefWidth="380" spacing="12">

                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="Schaden"/>

                    <!-- Schaden AUTO -->
                    <VBox spacing="8"
                          style="-fx-background-color: #FFFFFF; -fx-padding: 12; -fx-background-radius: 10; -fx-border-color: #EEEEEE; -fx-border-radius: 10;">
                        <Label style="-fx-font-weight: bold;" text="Automatisch (aus Schadenliste.xlsx)"/>
                        <Label style="-fx-font-size: 10px; -fx-text-fill: gray;"
                               text="Liest Schadenliste (Excel) und kopiert alle passenden Dokumente."/>
                        <HBox alignment="CENTER" spacing="10">
                            <!-- Auto (plein, vert) -->
                            <Button fx:id="startSchadenButton"
                                    onAction="#startSchadenAudit"
                                    prefHeight="40.0" prefWidth="150.0"
                                    text="Schaden-Audit"
                                    style="-fx-font-size:14px; -fx-font-weight:bold; -fx-background-color:#15a66b; -fx-text-fill:white; -fx-background-radius:24; -fx-padding:8 18;"/>
                            <!-- SB-Protokoll (plein, vert) -->
                            <Button fx:id="scheckSbMismatchSchaden"
                                    onAction="#checkSbMismatchSchaden"
                                    prefHeight="40.0" prefWidth="150.0"
                                    text="SB-Protokoll"
                                    style="-fx-font-size:14px; -fx-font-weight:bold; -fx-background-color:#15a66b; -fx-text-fill:white; -fx-background-radius:24; -fx-padding:8 18;"/>
                        </HBox>
                    </VBox>

                    <!-- Schaden MANUEL -->
                    <VBox spacing="8"
                          style="-fx-background-color: #FFFFFF; -fx-padding: 12; -fx-background-radius: 10; -fx-border-color: #EEEEEE; -fx-border-radius: 10;">
                        <Label style="-fx-font-weight: bold;" text="Manuell (Schaden Nr: YYxxxxx oder CS-20YY-xxxxx)"/>
                        <TextArea fx:id="manualSchadenInput"
                                  prefRowCount="3" prefColumnCount="26"
                                  promptText="z. B. 2408474, 2506266&#10;oder CS-2024-04343"/>
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <!-- Manuel (outline, vert) -->
                            <Button fx:id="startManualSchadenButton"
                                    onAction="#startSchadenAuditManuell"
                                    prefHeight="40.0" prefWidth="180.0"
                                    text="Schaden (manuell)"
                                    style="-fx-font-size:14px; -fx-font-weight:bold; -fx-background-color:transparent; -fx-border-color:#15a66b; -fx-border-width:2; -fx-text-fill:#15a66b; -fx-background-radius:24; -fx-border-radius:24; -fx-padding:8 18;"/>
                        </HBox>
                        <Label style="-fx-font-size: 10px; -fx-text-fill: gray;"
                               text="Trennzeichen: Komma ; Leerzeichen ; Zeilenumbruch. Formate mischbar."/>
                    </VBox>

                </VBox>

                <Separator orientation="VERTICAL" prefHeight="260"/>

                <!-- COLONNE DROITE : VERTRAG -->
                <VBox prefWidth="380" spacing="12">

                    <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="Verträge"/>

                    <!-- Vertrag AUTO -->
                    <VBox spacing="8"
                          style="-fx-background-color: #FFFFFF; -fx-padding: 12; -fx-background-radius: 10; -fx-border-color: #EEEEEE; -fx-border-radius: 10;">
                        <Label style="-fx-font-weight: bold;" text="Automatisch (aus Vertragsliste.xlsx)"/>
                        <Label style="-fx-font-size: 10px; -fx-text-fill: gray;"
                               text="Liest Vertragsliste (Excel) und kopiert alle passenden Dokumente."/>
                        <HBox alignment="CENTER" spacing="10">
                            <!-- Auto (plein, bleu) -->
                            <Button fx:id="startVertragButton"
                                    onAction="#startVertragAudit"
                                    prefHeight="40.0" prefWidth="150.0"
                                    text="Verträge-Audit"
                                    style="-fx-font-size:14px; -fx-font-weight:bold; -fx-background-color:#2d7ef7; -fx-text-fill:white; -fx-background-radius:24; -fx-padding:8 18;"/>
                            <!-- SB-Protokoll (plein, bleu) -->
                            <Button fx:id="scheckSbMismatchVertrag"
                                    onAction="#checkSbMismatchVertrag"
                                    prefHeight="40.0" prefWidth="150.0"
                                    text="SB-Protokoll"
                                    style="-fx-font-size:14px; -fx-font-weight:bold; -fx-background-color:#2d7ef7; -fx-text-fill:white; -fx-background-radius:24; -fx-padding:8 18;"/>
                        </HBox>
                    </VBox>

                    <!-- Vertrag MANUEL -->
                    <VBox spacing="8"
                          style="-fx-background-color: #FFFFFF; -fx-padding: 12; -fx-background-radius: 10; -fx-border-color: #EEEEEE; -fx-border-radius: 10;">
                        <Label style="-fx-font-weight: bold;" text="Manuell (Police Nr.)"/>
                        <TextArea fx:id="manualVertragInput"
                                  prefRowCount="3" prefColumnCount="26"
                                  promptText="z. B. W1040174, W1040175"/>
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <!-- Manuel (outline, bleu) -->
                            <Button fx:id="startManualVertragButton"
                                    onAction="#startVertragAuditManuell"
                                    prefHeight="40.0" prefWidth="180.0"
                                    text="Verträge (manuell)"
                                    style="-fx-font-size:14px; -fx-font-weight:bold; -fx-background-color:transparent; -fx-border-color:#2d7ef7; -fx-border-width:2; -fx-text-fill:#2d7ef7; -fx-background-radius:24; -fx-border-radius:24; -fx-padding:8 18;"/>
                        </HBox>
                        <Label style="-fx-font-size: 10px; -fx-text-fill: gray;"
                               text="Trennzeichen: Komma ; Leerzeichen ; Zeilenumbruch."/>
                    </VBox>

                </VBox>
            </HBox>

            <Separator prefWidth="800"/>

            <!-- Boutons globaux + Stop -->
            <HBox alignment="CENTER" spacing="20" style="-fx-padding: 6 0;">
                <Button fx:id="startBeideButton"
                        onAction="#startBeideAudit"
                        prefHeight="41.0" prefWidth="150.0"
                        text="BEIDE Audits"
                        style="-fx-font-size:14px; -fx-font-weight:bold; -fx-background-color:#607D8B; -fx-text-fill:white; -fx-background-radius:24; -fx-padding:8 18;"/>
                <Button fx:id="stopButton"
                        onAction="#stopAuditProcess"
                        prefHeight="41.0" prefWidth="120.0"
                        text="⏹ Stop"
                        style="-fx-font-size:14px; -fx-font-weight:bold; -fx-background-color:#F44336; -fx-text-fill:white; -fx-background-radius:24; -fx-padding:8 18;"/>
            </HBox>

            <!-- Progress + Status + Logs -->
            <VBox alignment="CENTER" spacing="8" VBox.vgrow="ALWAYS">
                <ProgressBar fx:id="progressBar" prefWidth="420" visible="false"/>
                <Label fx:id="statusLabel" style="-fx-font-style: italic;" text="Bereit zum Start"/>
                <ListView fx:id="stepsListView" prefHeight="160.0" prefWidth="800.0" VBox.vgrow="ALWAYS">
                    <VBox.margin>
                        <Insets top="6.0"/>
                    </VBox.margin>
                </ListView>
            </VBox>

        </VBox>
    </center>
</BorderPane>
